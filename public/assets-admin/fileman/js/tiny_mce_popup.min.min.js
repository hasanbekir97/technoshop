var tinymce=null,tinyMCEPopup,tinyMCE;tinyMCEPopup={init:function(){var c=this,b,a;b=c.getWin();tinymce=b.tinymce;tinyMCE=b.tinyMCE;c.editor=tinymce.EditorManager.activeEditor;c.params=c.editor.windowManager.params;c.features=c.editor.windowManager.features;c.dom=c.editor.windowManager.createInstance("tinymce.dom.DOMUtils",document,{ownEvents:true,proxy:tinyMCEPopup._eventProxy});c.dom.bind(window,"ready",c._onDOMLoaded,c);if(c.features.popup_css!==false){c.dom.loadCSS(c.features.popup_css||c.editor.settings.popup_css)}c.listeners=[];c.onInit={add:function(e,d){c.listeners.push({func:e,scope:d})}};c.isWindow=!c.getWindowArg("mce_inline");c.id=c.getWindowArg("mce_window_id");c.editor.windowManager.onOpen.dispatch(c.editor.windowManager,window)},getWin:function(){return(!window.frameElement&&window.dialogArguments)||opener||parent||top},getWindowArg:function(a,c){var b=this.params[a];return tinymce.is(b)?b:c},getParam:function(b,a){return this.editor.getParam(b,a)},getLang:function(b,a){return this.editor.getLang(b,a)},execCommand:function(d,c,e,b){b=b||{};b.skip_focus=1;this.restoreSelection();return this.editor.execCommand(d,c,e,b)},resizeToInnerSize:function(){var a=this;setTimeout(function(){var b=a.dom.getViewPort(window);a.editor.windowManager.resizeBy(a.getWindowArg("mce_width")-b.w,a.getWindowArg("mce_height")-b.h,a.id||window)},10)},executeOnLoad:function(s){this.onInit.add(function(){eval(s)})},storeSelection:function(){this.editor.windowManager.bookmark=tinyMCEPopup.editor.selection.getBookmark(1)},restoreSelection:function(){var a=tinyMCEPopup;if(!a.isWindow&&tinymce.isIE){a.editor.selection.moveToBookmark(a.editor.windowManager.bookmark)}},requireLangPack:function(){var b=this,a=b.getWindowArg("plugin_url")||b.getWindowArg("theme_url");if(a&&b.editor.settings.language&&b.features.translate_i18n!==false&&b.editor.settings.language_load!==false){a+="/langs/"+b.editor.settings.language+"_dlg.js";if(!tinymce.ScriptLoader.isDone(a)){document.write('<script type="text/javascript" src="'+tinymce._addVer(a)+'"><\/script>');tinymce.ScriptLoader.markDone(a)}}},pickColor:function(b,a){this.execCommand("mceColorPicker",true,{color:document.getElementById(a).value,func:function(d){document.getElementById(a).value=d;try{document.getElementById(a).onchange()}catch(c){}}})},openBrowser:function(b,a,c){tinyMCEPopup.restoreSelection();this.editor.execCallback("file_browser_callback",b,document.getElementById(b).value,a,window)},confirm:function(c,b,a){this.editor.windowManager.confirm(c,b,a,window)},alert:function(c,b,a){this.editor.windowManager.alert(c,b,a,window)},close:function(){var a=this;function b(){a.editor.windowManager.close(window);tinymce=tinyMCE=a.editor=a.params=a.dom=a.dom.doc=null}if(tinymce.isOpera){a.getWin().setTimeout(b,0)}else{b()}},_restoreSelection:function(){var a=window.event.srcElement;if(a.nodeName=="INPUT"&&(a.type=="submit"||a.type=="button")){tinyMCEPopup.restoreSelection()}},_onDOMLoaded:function(){var e=tinyMCEPopup,b=document.title,c,a,d;if(e.features.translate_i18n!==false){a=document.body.innerHTML;if(tinymce.isIE){a=a.replace(/ (value|title|alt)=([^"][^\s>]+)/gi,' $1="$2"')}document.dir=e.editor.getParam("directionality","");if((d=e.editor.translate(a))&&d!=a){document.body.innerHTML=d}if((d=e.editor.translate(b))&&d!=b){document.title=b=d}}if(!e.editor.getParam("browser_preferred_colors",false)||!e.isWindow){e.dom.addClass(document.body,"forceColors")}document.body.style.display="";if(tinymce.isIE){document.attachEvent("onmouseup",tinyMCEPopup._restoreSelection);e.dom.add(e.dom.select("head")[0],"base",{target:"_self"})}e.restoreSelection();e.resizeToInnerSize();if(!e.isWindow){e.editor.windowManager.setTitle(window,b)}else{window.focus()}if(!tinymce.isIE&&!e.isWindow){e.dom.bind(document,"focus",function(){e.editor.windowManager.focus(e.id)})}tinymce.each(e.dom.select("select"),function(f){f.onkeydown=tinyMCEPopup._accessHandler});tinymce.each(e.listeners,function(f){f.func.call(f.scope,e.editor)});if(e.getWindowArg("mce_auto_focus",true)){window.focus();tinymce.each(document.forms,function(f){tinymce.each(f.elements,function(g){if(e.dom.hasClass(g,"mceFocus")&&!g.disabled){g.focus();return false}})})}document.onkeyup=tinyMCEPopup._closeWinKeyHandler},_accessHandler:function(a){a=a||window.event;if(a.keyCode==13||a.keyCode==32){var b=a.target||a.srcElement;if(b.onchange){b.onchange()}return tinymce.dom.Event.cancel(a)}},_closeWinKeyHandler:function(a){a=a||window.event;if(a.keyCode==27){tinyMCEPopup.close()}},_eventProxy:function(a){return function(b){tinyMCEPopup.dom.events.callNativeHandler(a,b)}}};tinyMCEPopup.init();